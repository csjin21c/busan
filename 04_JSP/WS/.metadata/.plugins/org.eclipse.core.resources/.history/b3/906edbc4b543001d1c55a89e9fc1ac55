package pkgDB;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;

import pkgDB.DBBean;

// =================== 데이터베이스 컨트롤 클래스 ======================
public class DBDao {
	private Connection conn;//데이터베이스 연결
	private ResultSet rs;//테이블 레코드 반환
	
	// 1. 데이터베이스 연결
	public void dbConnect() {
		try {
			String dbURL = "jdbc:mysql://localhost:3306/study";
			String dbID = "devUser";
			String dbPassw = "devUser2022!";
			
			Class.forName("com.mysql.cj.jdbc.Driver");
			conn = DriverManager.getConnection(dbURL, dbID, dbPassw);
			System.out.println("DB연결 성공");
		}
		catch(Exception e) {
			System.out.println("DB연결 실패");
		}
	}
	
	//=============== 목록 출력 메서드, 출력을 JSP에서 함 =================
	public ArrayList<DBBean> getList(int pageNum) {
		ArrayList<DBBean> boardList = new ArrayList<>();
		try {
			dbConnect();//데이터베이스 연결
			String SQL = "SELECT FIDX, FPART FROM TBOARD_PART ORDER BY FIDX DESC "
					+ " limit 0, 10";
			PreparedStatement pstmt = conn.prepareStatement(SQL);
			rs = pstmt.executeQuery(SQL);
			System.out.println(SQL);
			while(rs.next()) {
				DBBean board = new DBBean();
				board.setIdx(rs.getInt("fidx"));
				board.setPart(rs.getString("fpart"));
				boardList.add(board);
			}
		}catch(Exception e) {
			//e.printStackTrace();
		}
		
		return boardList;
	}
	
	
	
	
	
}
